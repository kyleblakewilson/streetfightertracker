var exec = require('child_process').exec;
    fs = require('fs');
    crypto = require('crypto');

var tesseract = {
	process: function process( image, callback ) {
		exec("convert " + image + " -type Grayscale " + image, function(err, stdout, stderr){
			exec("convert " + image + " ( -clone 0 -transparent rgb(255,255,255) -transparent rgb(254,254,254) -transparent rgb(253,253,253) -transparent rgb(252,252,252) -transparent rgb(242,242,242) -alpha extract -fill black -opaque red -transparent red ) -compose over -composite " + image, function(err, stdout, stderr){
				exec("convert " + image + " -scale 300% " + image, function(err, stdout, stderr){
					/*
					exec("tesseract " + image + " " + image + " nobatch sf", function(err, stdout, stderr){
						if(err) throw err;    
						fs.readFile(image + '.txt', function(err,data){
						if(err) throw err;
						text = data.toString('ascii').replace(/(\r\n|\n|\r)/gm,"");
							fs.unlink(image + '.txt', function (err) {
								if (err) throw err;
								fs.unlink(image, function (err) {
									if (err) throw err;
								});
							});
							callback(err, text);
						});
					});
					*/
				});
			});
		});
	}
}

module.exports.process = tesseract.process;0